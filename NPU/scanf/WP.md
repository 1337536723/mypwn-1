# scanf大小姐想让我告白  
打开程序后可以选择加减乘除四种运算，而且可以重复调用无次数限制。    
加法和乘法存在bug，输入一个数字n，之后输入n个数字存入数组，再输出这n个数字的和或者积。1但是n没有限定范围，可以构造ROP链  
![](./pics/funadd.png)
由于保护全开，需要先知道libcbase和canary。  
考察的是scanf的特性，使用scanf("%d",&pos)写数字，传入字符'+'可以跳过读写不改变地址原先存放的内容。  
可以这样获得栈里的数据。  
因此实际上canary也不需要知道，在遇到它时传'+'跳过就行了。  
add函数的栈帧如下：  
![](./pics/stack.png)  
本来一开始想的是直接把rbp后面的一个libc地址的最后几字节覆盖成onegadget，然后为了保证栈帧平衡得把前面cmp eax,4的地方改成一个程序内pop的地址。  
这种做法可行但是需要进行爆破，成功概率好像是1/16^4，所以最终没采用此方法。